{"ast":null,"code":"'use strict';\n\nconst nacl = require('tweetnacl');\n\nconst setImmediate = require('async/setImmediate');\n\nexports.publicKeyLength = nacl.sign.publicKeyLength;\nexports.privateKeyLength = nacl.sign.secretKeyLength;\n\nexports.generateKey = function (callback) {\n  setImmediate(() => {\n    let result;\n\n    try {\n      result = nacl.sign.keyPair();\n    } catch (err) {\n      return callback(err);\n    }\n\n    callback(null, result);\n  });\n}; // seed should be a 32 byte uint8array\n\n\nexports.generateKeyFromSeed = function (seed, callback) {\n  setImmediate(() => {\n    let result;\n\n    try {\n      result = nacl.sign.keyPair.fromSeed(seed);\n    } catch (err) {\n      return callback(err);\n    }\n\n    callback(null, result);\n  });\n};\n\nexports.hashAndSign = function (key, msg, callback) {\n  setImmediate(() => {\n    callback(null, Buffer.from(nacl.sign.detached(msg, key)));\n  });\n};\n\nexports.hashAndVerify = function (key, sig, msg, callback) {\n  setImmediate(() => {\n    let result;\n\n    try {\n      result = nacl.sign.detached.verify(msg, sig, key);\n    } catch (err) {\n      return callback(err);\n    }\n\n    callback(null, result);\n  });\n};","map":null,"metadata":{},"sourceType":"script"}