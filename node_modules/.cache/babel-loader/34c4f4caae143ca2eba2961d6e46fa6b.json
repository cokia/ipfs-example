{"ast":null,"code":"'use strict';\n\nconst forge = require('node-forge');\n/**\n * Maps an IPFS hash name to its node-forge equivalent.\n *\n * See https://github.com/multiformats/multihash/blob/master/hashtable.csv\n *\n * @private\n */\n\n\nconst hashName = {\n  sha1: 'sha1',\n  'sha2-256': 'sha256',\n  'sha2-512': 'sha512'\n  /**\n   * Computes the Password-Based Key Derivation Function 2.\n   *\n   * @param {string} password\n   * @param {string} salt\n   * @param {number} iterations\n   * @param {number} keySize (in bytes)\n   * @param {string} hash - The hash name ('sha1', 'sha2-512, ...)\n   * @returns {string} - A new password\n   */\n\n};\n\nfunction pbkdf2(password, salt, iterations, keySize, hash) {\n  const hasher = hashName[hash];\n\n  if (!hasher) {\n    throw new Error(\"Hash '\".concat(hash, \"' is unknown or not supported\"));\n  }\n\n  const dek = forge.pkcs5.pbkdf2(password, salt, iterations, keySize, hasher);\n  return forge.util.encode64(dek);\n}\n\nmodule.exports = pbkdf2;","map":null,"metadata":{},"sourceType":"script"}