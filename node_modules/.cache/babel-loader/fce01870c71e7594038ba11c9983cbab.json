{"ast":null,"code":"'use strict';\n\nconst assert = require('assert');\n\nconst withIs = require('class-is');\n\nconst CID = require('cids');\n\nclass DAGNode {\n  constructor(data, links, serialized, multihash) {\n    assert(serialized, 'DAGNode needs its serialized format');\n    assert(multihash, 'DAGNode needs its multihash');\n    this._cid = new CID(multihash);\n    this._data = data || Buffer.alloc(0);\n    this._links = links || [];\n    this._serialized = serialized;\n  }\n\n  toJSON() {\n    if (!this._json) {\n      this._json = Object.freeze({\n        data: this.data,\n        links: this.links.map(l => l.toJSON()),\n        multihash: this._cid.toBaseEncodedString(),\n        size: this.size\n      });\n    }\n\n    return Object.assign({}, this._json);\n  }\n\n  toString() {\n    return \"DAGNode <\".concat(this._cid.toBaseEncodedString(), \" - data: \\\"\").concat(this.data.toString(), \"\\\", links: \").concat(this.links.length, \", size: \").concat(this.size, \">\");\n  }\n\n  get data() {\n    return this._data;\n  }\n\n  set data(data) {\n    throw new Error(\"Can't set property: 'data' is immutable\");\n  }\n\n  get links() {\n    return this._links;\n  }\n\n  set links(links) {\n    throw new Error(\"Can't set property: 'links' is immutable\");\n  }\n\n  get serialized() {\n    return this._serialized;\n  }\n\n  set serialized(serialized) {\n    throw new Error(\"Can't set property: 'serialized' is immutable\");\n  }\n\n  get size() {\n    if (this._size === undefined) {\n      this._size = this.links.reduce((sum, l) => sum + l.size, this.serialized.length);\n    }\n\n    return this._size;\n  }\n\n  set size(size) {\n    throw new Error(\"Can't set property: 'size' is immutable\");\n  }\n\n  get multihash() {\n    return this._cid.buffer;\n  }\n\n  set multihash(multihash) {\n    throw new Error(\"Can't set property: 'multihash' is immutable\");\n  }\n\n  get cid() {\n    return this._cid;\n  }\n\n  set cid(cid) {\n    throw new Error(\"Can't set property: 'cid' is immutable\");\n  }\n\n}\n\nexports = module.exports = withIs(DAGNode, {\n  className: 'DAGNode',\n  symbolName: '@ipld/js-ipld-dag-pb/dagnode'\n});\nexports.create = require('./create');\nexports.clone = require('./clone');\nexports.addLink = require('./addLink');\nexports.rmLink = require('./rmLink');","map":null,"metadata":{},"sourceType":"script"}