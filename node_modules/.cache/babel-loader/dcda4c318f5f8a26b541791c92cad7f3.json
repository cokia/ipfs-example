{"ast":null,"code":"'use strict';\n\nconst nodeify = require('../nodeify');\n\nconst crypto = require('../webcrypto');\n\nconst lengths = require('./lengths');\n\nconst hashTypes = {\n  SHA1: 'SHA-1',\n  SHA256: 'SHA-256',\n  SHA512: 'SHA-512'\n};\n\nconst sign = (key, data, cb) => {\n  nodeify(crypto.subtle.sign({\n    name: 'HMAC'\n  }, key, data).then(raw => Buffer.from(raw)), cb);\n};\n\nexports.create = function (hashType, secret, callback) {\n  const hash = hashTypes[hashType];\n  nodeify(crypto.subtle.importKey('raw', secret, {\n    name: 'HMAC',\n    hash: {\n      name: hash\n    }\n  }, false, ['sign']).then(key => {\n    return {\n      digest(data, cb) {\n        sign(key, data, cb);\n      },\n\n      length: lengths[hashType]\n    };\n  }), callback);\n};","map":null,"metadata":{},"sourceType":"script"}